<!DOCTYPE html>
<html lang="en-us">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <meta itemprop="name" content="desmo" />
  <meta itemprop="description" content="Random Ideas" />

  <link rel="apple-touch-icon" sizes="180x180" href="https://desmodrone.github.io/apple-touch-icon.png"/>
  <link rel="icon" type="image/png" sizes="32x32" href="https://desmodrone.github.io/favicon-32x32.png" />
  <link
    rel="icon"
    type="image/png"
    sizes="16x16"
    href="https://desmodrone.github.io/favicon-16x16.png"
  />
  <link
    rel="shortcut icon"
    href="https://desmodrone.github.io/favicon.ico"
  />
  <link rel="stylesheet" href="https://desmodrone.github.io/style.css"/>
  
  <title>14 Rustlings Options</title>
  

  
  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://desmodrone.github.io/rss.xml">
  

  <body id="page">

	
<header id="site-header" class="animated slideInUp faster">
  <div class="hdr-wrapper section-inner">
    <div class="hdr-left">
      <div class="site-branding">
        <a href="https:&#x2F;&#x2F;desmodrone.github.io">desmo</a>
      </div>
      <nav class="site-nav hide-in-mobile">
            
        
        <a href="https://desmodrone.github.io/posts">posts</a>
        
        <a href="https://desmodrone.github.io/about">about</a>
        
        <a href="https://desmodrone.github.io/work">work</a>
        
      </nav>
    </div>
    <div class="hdr-right hdr-icons">
      <span class="hdr-social hide-in-mobile">
        

<a href="https:&#x2F;&#x2F;twitter.com&#x2F;desmodrone_" target="_blank" rel="noopener me"
   title="twitter">
  
  <svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
  
</a>

<a href="https:&#x2F;&#x2F;github.com&#x2F;desmodrone" target="_blank" rel="noopener me"
   title="github">
  
  <svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>
  
</a>

<a href="mailto:erick@apexwins.com" target="_blank" rel="noopener me"
   title="email">
  
  <svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
  
</a>


      </span>
      <button id="menu-btn" class="hdr-btn" title="Menu">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="feather feather-menu"
        >
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
    </div>
  </div>
</header>
<div id="mobile-menu" class="animated fast">
  <ul>
    
    <li><a href="https://desmodrone.github.io/posts">posts</a></li>
    
    <li><a href="https://desmodrone.github.io/about">about</a></li>
    
    <li><a href="https://desmodrone.github.io/work">work</a></li>
    
  </ul>
</div>

	
	

		
<main class="site-main section-inner animated fadeIn faster">
  <article class="thin">
	<header class="post-header">
	  <div class="post-meta">
		
		<span>Jul 31, 2023</span>
		<small> - 
<span class="reading-time" title="Estimated read time">
  
  11 min read
  
</span>
</small>
		
            
	  </div>
	  <h1>14 Rustlings Options</h1>
	</header>

	<div class="content">
        
	  <h1 id="options">Options</h1>
<h5 id="from-the-rustlings-readme">From the Rustlings README</h5>
<p>Type Option represents an optional value: every Option is either Some and contains a value, or None, and does not.
Option types are very common in Rust code, as they have a number of uses:</p>
<ul>
<li>Initial values</li>
<li>Return values for functions that are not defined over their entire input range (partial functions)</li>
<li>Return value for otherwise reporting simple errors, where None is returned on error</li>
<li>Optional struct fields</li>
<li>Struct fields that can be loaned or &quot;taken&quot;</li>
<li>Optional function arguments</li>
<li>Nullable pointers</li>
<li>Swapping things out of difficult situations</li>
</ul>
<h2 id="further-information">Further Information</h2>
<ul>
<li><a href="https://doc.rust-lang.org/stable/book/ch10-01-syntax.html#in-enum-definitions">Option Enum Format</a></li>
<li><a href="https://doc.rust-lang.org/std/option/">Option Module Documentation</a></li>
<li><a href="https://doc.rust-lang.org/std/option/enum.Option.html">Option Enum Documentation</a></li>
<li><a href="https://doc.rust-lang.org/rust-by-example/flow_control/if_let.html">if let</a></li>
<li><a href="https://doc.rust-lang.org/rust-by-example/flow_control/while_let.html">while let</a></li>
</ul>
<h2 id="options1-rs">Options1.rs</h2>
<pre data-lang="rust" class="language-rust "><code class="language-rust" data-lang="rust">&#x2F;&#x2F; options1.rs
&#x2F;&#x2F; Execute `rustlings hint options1` or use the `hint` watch subcommand for a hint.

&#x2F;&#x2F; I AM NOT DONE

&#x2F;&#x2F; This function returns how much icecream there is left in the fridge.
&#x2F;&#x2F; If it&#x27;s before 10PM, there&#x27;s 5 pieces left. At 10PM, someone eats them
&#x2F;&#x2F; all, so there&#x27;ll be no more left :(
fn maybe_icecream(time_of_day: u16) -&gt; Option&lt;u16&gt; {
    &#x2F;&#x2F; We use the 24-hour system here, so 10PM is a value of 22 and 12AM is a value of 0
    &#x2F;&#x2F; The Option output should gracefully handle cases where time_of_day &gt; 23.
    &#x2F;&#x2F; TODO: Complete the function body - remember to return an Option!
    ???
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn check_icecream() {
        assert_eq!(maybe_icecream(9), Some(5));
        assert_eq!(maybe_icecream(10), Some(5));
        assert_eq!(maybe_icecream(23), Some(0));
        assert_eq!(maybe_icecream(22), Some(0));
        assert_eq!(maybe_icecream(25), None);
    }

    #[test]
    fn raw_value() {
        &#x2F;&#x2F; TODO: Fix this test. How do you get at the value contained in the Option?
        let icecreams = maybe_icecream(12);
        assert_eq!(icecreams, 5);
    }
}
</code></pre>
<p>Our instructions in this exercise are to create the logic in the <code>maybe_icecream</code> body which should tell us how much ice cream is left depending on the time of day -- for example if it's 9pm there should be some ice cream but if it's 11pm there should be no ice-cream. Next, we have to fix the text so we get the value that is contained inside of the Option.</p>
<h2 id="options1-rs-errors">Options1.rs Errors</h2>
<pre><code>⚠️  Compiling of exercises&#x2F;options&#x2F;options1.rs failed! Please try again. Here&#x27;s the output:
error: expected expression, found `?`
  --&gt; exercises&#x2F;options&#x2F;options1.rs:13:5
   |
13 |     ???
   |     ^ expected expression

error[E0308]: mismatched types
  --&gt; exercises&#x2F;options&#x2F;options1.rs:33:9
   |
33 |         assert_eq!(icecreams, 5);
   |         ^^^^^^^^^^^^^^^^^^^^^^^^
   |         |
   |         expected enum `Option`, found integer
   |         expected because this is `Option&lt;u16&gt;`
   |
   = note: expected enum `Option&lt;u16&gt;`
              found type `{integer}`
   = note: this error originates in the macro `assert_eq` (in Nightly builds, run with -Z macro-backtrace for more info)
help: try wrapping the expression in `Some`
  --&gt; &#x2F;Users&#x2F;desmo&#x2F;.rustup&#x2F;toolchains&#x2F;stable-aarch64-apple-darwin&#x2F;lib&#x2F;rustlib&#x2F;src&#x2F;rust&#x2F;library&#x2F;core&#x2F;src&#x2F;macros&#x2F;mod.rs:40:35
   |
40 |                 if !(*left_val == Some(*right_val)) {
   |                                   +++++          +

error: aborting due to 2 previous errors
</code></pre>
<p>There are some clear hints on how to fix this issues in the errors</p>
<h2 id="options1-rs-solution">Options1.rs solution</h2>
<p>Looking at the errors the Rust compiler offers a direct hint for how to solve the test. Let's tackle that one first since it looks super easy the compiler we fix it by wrapping our value in <code>Some()</code> as suggested like this:</p>
<pre data-lang="rust" class="language-rust "><code class="language-rust" data-lang="rust">  #[test]
    fn raw_value() {
        &#x2F;&#x2F; TODO: Fix this test. How do you get at the value contained in the Option?
        let icecreams = maybe_icecream(12);
        assert_eq!(icecreams, Some(5));
    }
}
</code></pre>
<p>This fixes the issue in our test, now on to the <code>maybe_icecream</code> function.</p>
<h3 id="maybe-ice-cream">Maybe Ice Cream</h3>
<p>So our instructions are to return the amount of ice cream left in the fridge. So from this we understand that we have to return a value as an <code>Option&lt;u16&gt;</code> by looking at the function signature. So, in the next sentence we get a big hint as to the type of function body we have to write because the instructions start with an &quot;If&quot; meaning we should be able to use a <code>If</code> statement in our function body. Let's see what that could look like. In pseudo code:</p>
<pre><code>if time of day is &lt; 10pm
	then 5
if time of day &gt; 10pm
	then 0
</code></pre>
<p>Now, I started implementing this pseudo code but then realized that we actually have to pass 3 different test cases. Let's write this in the 24 hour clock system because it's easier.</p>
<ol>
<li>Before 22</li>
<li>After 22 or 23</li>
<li>Something else: 25</li>
</ol>
<p>For item 3, we can see it explicitly stated in our test code:</p>
<pre data-lang="rust" class="language-rust "><code class="language-rust" data-lang="rust">    fn check_icecream() {
        assert_eq!(maybe_icecream(9), Some(5));
        assert_eq!(maybe_icecream(10), Some(5));
        assert_eq!(maybe_icecream(23), Some(0));
        assert_eq!(maybe_icecream(22), Some(0));
        assert_eq!(maybe_icecream(25), None);
</code></pre>
<p>So now, we know that we have to cover three different test cases <code>Some(5)</code>, <code>Some(0)</code> and <code>None</code>.  Let's implement this in Rust, keeping in mind the  instructions to use a 24 clock system.</p>
<pre data-lang="rust" class="language-rust "><code class="language-rust" data-lang="rust">fn maybe_icecream(time_of_day: u16) -&gt; Option&lt;u16&gt; {
    if time_of_day &lt; 22 {
        Some(5)
    } else if time_of_day == 22 || time_of_day == 23 {
        Some(0)
    } else {
        None
    }
}
</code></pre>
<h3 id="using-match">Using <code>match</code></h3>
<p>Another way to solve this problem in a more concise way would be to use a match statement and that could look something like this:</p>
<pre data-lang="rust" class="language-rust "><code class="language-rust" data-lang="rust">fn maybe_icecream(time_of_day: u16) -&gt; Option&lt;u16&gt; {
    match time_of_day {
        0..=21 =&gt; Some(5),
        22..=23 =&gt; Some(0),
        _ =&gt; None,
    }
}
</code></pre>
<p>as you can see this is cleaner way of implementing a solution that handles all of our cases. Remember when using ranges you can use the <code>..=</code> to include the element in the range so in our case <code>0...=21</code> means from midnight to 9pm, and <code>22..=23</code> means from 10pm to 11pm.</p>
<h2 id="options2-rs">Options2.rs</h2>
<pre data-lang="rust" class="language-rust "><code class="language-rust" data-lang="rust">&#x2F;&#x2F; options2.rs
&#x2F;&#x2F; Execute `rustlings hint options2` or use the `hint` watch subcommand for a hint.

&#x2F;&#x2F; I AM NOT DONE

#[cfg(test)]
mod tests {
    #[test]
    fn simple_option() {
        let target = &quot;rustlings&quot;;
        let optional_target = Some(target);

        &#x2F;&#x2F; TODO: Make this an if let statement whose value is &quot;Some&quot; type
        if let Some(word) = optional_target {
            assert_eq!(word, target);
        }
    }

    #[test]
    fn layered_option() {
        let mut range = 10;
        let mut optional_integers: Vec&lt;Option&lt;i8&gt;&gt; = Vec::new();
        for i in 0..(range + 1) {
            optional_integers.push(Some(i));
        }

        &#x2F;&#x2F; TODO: make this a while let statement - remember that vector.pop also adds another layer of Option&lt;T&gt;
        &#x2F;&#x2F; You can stack `Option&lt;T&gt;`&#x27;s into while let and if let
        integer = optional_integers.pop() {
            assert_eq!(integer, range);
            range -= 1;
        }
    }
}

</code></pre>
<p>We have a couple of TODO's here one in the <code>simple_option</code> function that asks us to use a <code>if let</code> statement and then the next on the list asks for a <code>while let</code> statement with a reminder that using <code>vector.pop</code> also adds another layer of <code>Option&lt;T&gt;</code>, noting that we can 'stack' <code>Option&lt;T&gt;</code>'s when using <code>while let</code> and <code>if let</code>.</p>
<h2 id="options2-rs-errors">Options2.rs errors</h2>
<pre><code>⚠️  Compiling of exercises&#x2F;options&#x2F;options2.rs failed! Please try again. Here&#x27;s the output:
error: expected one of `,`, `:`, or `}`, found `!`
  --&gt; exercises&#x2F;options&#x2F;options2.rs:15:22
   |
14 |         word = optional_target {
   |                --------------- while parsing this struct
15 |             assert_eq!(word, target);
   |                      ^ expected one of `,`, `:`, or `}`

error: expected one of `,`, `:`, or `}`, found `)`
  --&gt; exercises&#x2F;options&#x2F;options2.rs:15:36
   |
14 |         word = optional_target {
   |                --------------- while parsing this struct
15 |             assert_eq!(word, target);
   |                                    ^ expected one of `,`, `:`, or `}`

error: expected one of `.`, `;`, `?`, `}`, or an operator, found `{`
  --&gt; exercises&#x2F;options&#x2F;options2.rs:29:43
   |
29 |         integer = optional_integers.pop() {
   |                                           ^ expected one of `.`, `;`, `?`, `}`, or an operator

error[E0425]: cannot find value `word` in this scope
  --&gt; exercises&#x2F;options&#x2F;options2.rs:14:9
   |
14 |         word = optional_target {
   |         ^^^^
   |
help: you might have meant to introduce a new binding
   |
14 |         let word = optional_target {
   |         +++

error[E0574]: expected struct, variant or union type, found local variable `optional_target`
  --&gt; exercises&#x2F;options&#x2F;options2.rs:14:16
   |
14 |         word = optional_target {
   |                ^^^^^^^^^^^^^^^ not a struct, variant or union type

error: aborting due to 5 previous errors
</code></pre>
<p>The error's don't give us a lot of a lot of hints in this case other letting us know that we probably want to introduce a new binding at line 14. So let's start there.</p>
<h2 id="options2-rs-solution">Options2.rs solution</h2>
<p>Using <code>if let</code> bindings allow us to sort of use a match statement, that is less awkward in cases where there is only one correct outcome and we'd have to use <code>_</code> to be exhaustive. which would lead to some cluncky code like in this example from <a href="https://doc.rust-lang.org/rust-by-example/flow_control/if_let.html">Rust by Example</a></p>
<pre data-lang="rust" class="language-rust "><code class="language-rust" data-lang="rust">&#x2F;&#x2F; Make `optional` of type `Option&lt;i32&gt;`
let optional = Some(7);

match optional {
    Some(i) =&gt; {
        println!(&quot;This is a really long string and `{:?}`&quot;, i);
        &#x2F;&#x2F; ^ Needed 2 indentations just so we could destructure
        &#x2F;&#x2F; `i` from the option.
    },
    _ =&gt; {},
    &#x2F;&#x2F; ^ Required because `match` is exhaustive. Doesn&#x27;t it seem
    &#x2F;&#x2F; like wasted space?
};
</code></pre>
<p>So let's try using <code>if let</code> on our first TODO.</p>
<pre data-lang="rust" class="language-rust "><code class="language-rust" data-lang="rust">if let Some(word) = optional_target { &#x2F;&#x2F; binding with `if let` wrapping `word` with Some
	assert_eq!(word, target);
}
</code></pre>
<p>With this we can save and see how our error's look.</p>
<pre><code>⚠️  Compiling of exercises&#x2F;options&#x2F;options2.rs failed! Please try again. Here&#x27;s the output:
error: expected one of `.`, `;`, `?`, `}`, or an operator, found `{`
  --&gt; exercises&#x2F;options&#x2F;options2.rs:29:43
   |
29 |         integer = optional_integers.pop() {
   |                                           ^ expected one of `.`, `;`, `?`, `}`, or an operator

error: aborting due to previous error
</code></pre>
<p>Okay we went from 5 error's to 1, great let's work on that next part of the code with <code>while let</code>. Similar to <code>if let</code> using <code>while let</code> can make matching sequences easier to use in this case in a loop type setting. So let's try and implement the solution in the same way we did with the <code>if let</code> binding.</p>
<pre data-lang="rust" class="language-rust "><code class="language-rust" data-lang="rust">        &#x2F;&#x2F; TODO: make this a while let statement - remember that vector.pop also adds another layer of Option&lt;T&gt;
        &#x2F;&#x2F; You can stack `Option&lt;T&gt;`&#x27;s into while let and if let
        while let Some(integer) = optional_integers.pop() {
            assert_eq!(integer, range);
            range -= 1;
        }
</code></pre>
<p>Let's see what happens...wait there's an error</p>
<pre><code>⚠️  Compiling of exercises&#x2F;options&#x2F;options2.rs failed! Please try again. Here&#x27;s the output:
error[E0308]: mismatched types
  --&gt; exercises&#x2F;options&#x2F;options2.rs:30:13
   |
30 |             assert_eq!(integer, range);
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^
   |             |
   |             expected `Option&lt;i8&gt;`, found `i8`
   |             expected because this is `Option&lt;i8&gt;`
   |
   = note: expected enum `Option&lt;i8&gt;`
              found type `i8`
   = note: this error originates in the macro `assert_eq` (in Nightly builds, run with -Z macro-backtrace for more info)
help: try wrapping the expression in `Some`
  --&gt; &#x2F;Users&#x2F;desmo&#x2F;.rustup&#x2F;toolchains&#x2F;stable-aarch64-apple-darwin&#x2F;lib&#x2F;rustlib&#x2F;src&#x2F;rust&#x2F;library&#x2F;core&#x2F;src&#x2F;macros&#x2F;mod.rs:40:35
   |
40 |                 if !(*left_val == Some(*right_val)) {
   |                                   +++++          +

error: aborting due to previous error
</code></pre>
<p>The compiler is telling us that it expects an <code>Option&lt;i8&gt;</code> but it's finding an <code>i8</code>...interesting. But wait let's look at that TODO comment: <code>remember that vector.pop also adds another layer of Option&lt;T&gt;</code> there it is. There's another layer of <code>Option&lt;T&gt;</code> that's created with <code>vector.pop</code> so does that mean that we have to wrap our <code>Some()</code> with <code>Some()</code>? Let's try.</p>
<pre data-lang="rust" class="language-rust "><code class="language-rust" data-lang="rust">while let Some(Some(integer)) = optional_integers.pop() {
            assert_eq!(integer, range);
            range -= 1;
        }
</code></pre>
<p>Success! This is our output</p>
<pre><code>✅ Successfully tested exercises&#x2F;options&#x2F;options2.rs!

🎉 🎉  The code is compiling, and the tests pass! 🎉 🎉
</code></pre>
<p>Let's move on to our final Option exercise.</p>
<h2 id="options3-rs">Options3.rs</h2>
<pre data-lang="rust" class="language-rust "><code class="language-rust" data-lang="rust">&#x2F;&#x2F; options3.rs
&#x2F;&#x2F; Execute `rustlings hint options3` or use the `hint` watch subcommand for a hint.

&#x2F;&#x2F; I AM NOT DONE

struct Point {
    x: i32,
    y: i32,
}

fn main() {
    let y: Option&lt;Point&gt; = Some(Point { x: 100, y: 200 });

    match y {
        Some(p) =&gt; println!(&quot;Co-ordinates are {},{} &quot;, p.x, p.y),
        _ =&gt; println!(&quot;no match&quot;),
    }
    y; &#x2F;&#x2F; Fix without deleting this line.
}
</code></pre>
<p>We're not getting a lot of instruction here but we're being told to fix this code without removing the <code>y;</code> on line 18. Let's take a look at the errors.</p>
<h2 id="options3-rs-errors">Options3.rs errors</h2>
<pre><code>⚠️  Compiling of exercises&#x2F;options&#x2F;options3.rs failed! Please try again. Here&#x27;s the output:
error[E0382]: use of partially moved value: `y`
  --&gt; exercises&#x2F;options&#x2F;options3.rs:18:5
   |
15 |         Some(p) =&gt; println!(&quot;Co-ordinates are {},{} &quot;, p.x, p.y),
   |              - value partially moved here
...
18 |     y; &#x2F;&#x2F; Fix without deleting this line.
   |     ^ value used here after partial move
   |
   = note: partial move occurs because value has type `Point`, which does not implement the `Copy` trait
help: borrow this binding in the pattern to avoid moving the value
   |
15 |         Some(ref p) =&gt; println!(&quot;Co-ordinates are {},{} &quot;, p.x, p.y),
   |              +++

error: aborting due to previous error
</code></pre>
<p>In this case we get a big hint as to what is going on with the code and a very direct suggestion as to how to fix it it, let's see what happens if we implement the compiler suggestion.</p>
<pre data-lang="rust" class="language-rust "><code class="language-rust" data-lang="rust">fn main() {
    let y: Option&lt;Point&gt; = Some(Point { x: 100, y: 200 });

    match y {
        Some(ref p) =&gt; println!(&quot;Co-ordinates are {},{} &quot;, p.x, p.y), &#x2F;&#x2F; adding `ref`
        _ =&gt; println!(&quot;no match&quot;),
    }
    y; &#x2F;&#x2F; Fix without deleting this line.
}
</code></pre>
<p>...and it compiles! Easy enough but let's take a deeper look at this, what is this <code>ref</code> and is it the same as <code>&amp;</code>?</p>
<p>So first let's understand a little bit more about what is happening in this code and when we should use <code>ref</code>.</p>
<p>In Rust, the <code>ref</code> keyword is used in patterns to create a reference to a value instead of moving it. This is particularly useful when dealing with non-<code>Copy</code> types (types that don't implement the <code>Copy</code> trait) to avoid moving the value out of its original location, which would leave the original variable uninitialized or unusable.</p>
<p>When pattern matching on a non-<code>Copy</code> value, Rust requires us to either move the value or borrow it explicitly. The <code>ref</code> keyword helps us create a reference to the value instead of moving it.</p>
<p>In our error message, the compiler is complaining about a partially moved value, specifically the variable <code>y</code>, which is of type <code>Point</code>. Since <code>Point</code> does not implement the <code>Copy</code> trait, the pattern matching on <code>Some(p)</code> is attempting to move the value of <code>p</code>, causing a partial move of the variable <code>y</code>.</p>
<p>With <code>ref p</code>, we are now creating a reference to the <code>Point</code> value inside the <code>Some</code> variant, which avoids the move and allows you to access the <code>x</code> and <code>y</code> fields without any issues.</p>
<p>Remember that we need to use <code>ref</code> in the pattern for non-<code>Copy</code> types when matching on references. When using <code>ref</code>, you are borrowing the value, and if we don't use <code>ref</code>, you are moving the value out of the original variable. This is crucial to understand when dealing with non-<code>Copy</code> types in pattern matching.</p>
<p>Alright, but what was the difference between <code>ref</code> and <code>&amp;</code> again?</p>
<p>Using <code>ref</code> in a pattern and using <code>&amp;</code> in a pattern are related concepts but serve slightly different purposes in Rust.</p>
<p>Using <code>ref</code> in a pattern:
- The <code>ref</code> keyword is used in pattern matching to create a reference to a value inside a pattern. It allows you to match on the reference to the value rather than moving the value out of the original variable.
- It is particularly useful when dealing with non-<code>Copy</code> types, as it allows you to borrow the value instead of moving it, preserving the original variable's ownership.
- <code>ref</code> can only be used in patterns, specifically in match arms or when destructuring tuples or structs.</p>
<p>Our example code using <code>ref</code>:</p>
<pre data-lang="rust" class="language-rust "><code class="language-rust" data-lang="rust">struct Point {
    x: i32,
    y: i32,
}

fn print_coordinates(point: Option&lt;Point&gt;) {
    match point {
        Some(ref p) =&gt; println!(&quot;Co-ordinates are {},{} &quot;, p.x, p.y),
        None =&gt; println!(&quot;No point found!&quot;),
    }
}

</code></pre>
<p>Using <code>&amp;</code> in a pattern:</p>
<ul>
<li>The <code>&amp;</code> symbol in a pattern is used to destructure a reference. It allows you to match on the value being referenced instead of matching on the reference itself.</li>
<li>It is commonly used when working with references to allow pattern matching without consuming the reference.</li>
<li><code>&amp;</code> can also be used in match arms and when destructuring tuples or structs, just like <code>ref</code>.</li>
</ul>
<p>Example using <code>&amp;</code>:</p>
<pre data-lang="rust" class="language-rust "><code class="language-rust" data-lang="rust">fn print_coordinates_ref(point: Option&lt;&amp;Point&gt;) {
    match point {
        Some(p) =&gt; println!(&quot;Co-ordinates are {},{} &quot;, p.x, p.y),
        None =&gt; println!(&quot;No point found!&quot;),
    }
}
</code></pre>
<p>In the first example, we use <code>ref</code> to match on the <code>Point</code> value by creating a reference <code>&amp;Point</code> and avoid moving the original value out of the <code>Option</code>. In the second example, we take a reference as an argument to the function and use <code>&amp;</code> to destructure the reference and match on the underlying <code>Point</code> value.</p>
<p>Both <code>ref</code> and <code>&amp;</code> in patterns are essential tools when working with pattern matching and references in Rust. They allow you to control ownership and borrowing behavior while pattern matching on non-<code>Copy</code> types.</p>
<h2 id="conclusion">Conclusion</h2>
<p>In conclusion, the Rust <code>Option</code> type is a fundamental concept that plays a crucial role in handling optional values in Rust code. It provides a safe and elegant way to deal with scenarios where a value may or may not be present. With <code>Option</code>, Rust encourages developers to handle potential absence of values explicitly, reducing the risk of null-related errors that are prevalent in other programming languages.</p>
<p>Throughout this blog post, we explored the versatility of <code>Option</code> and its various applications in Rust code. We learned that <code>Option</code> is commonly used for representing initial values, handling partial functions, reporting errors, working with optional struct fields, and more.</p>
<p>In addition to understanding the basics of <code>Option</code>, we also explored important Rust concepts like pattern matching, <code>if let</code>, and <code>while let</code>. These powerful language features allow us to handle <code>Option</code> values efficiently, making our code concise and expressive.</p>
<p>When working with non-<code>Copy</code> types, we encountered the use of <code>ref</code> in patterns, which creates a reference to the value, preventing it from being moved. This is particularly useful when matching on references to avoid unnecessary ownership transfers.</p>
<p>Furthermore, we compared <code>ref</code> with using <code>&amp;</code> in patterns, noting that both have distinct purposes. While <code>ref</code> is primarily used for pattern matching, <code>&amp;</code> is used for destructuring references.</p>
<p>In summary, mastering the Rust <code>Option</code> type and related language features empowers developers to write robust, safe, and efficient code. Embracing the principles of handling optional values in Rust not only improves code quality but also fosters better programming practices. By avoiding null-related issues, Rust's <code>Option</code> encourages developers to write more reliable software, making Rust a language of choice for projects requiring high-level safety and correctness guarantees.</p>

	</div>
	<hr class="post-end">
	<footer class="post-info">
    
	  <p>
		<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>
		
		
		<span class="tag"><a href="https://desmodrone.github.io/tags/rust/">rust</a></span>
		
		<span class="tag"><a href="https://desmodrone.github.io/tags/options/">options</a></span>
		
		<span class="tag"><a href="https://desmodrone.github.io/tags/match/">match</a></span>
		
		<span class="tag"><a href="https://desmodrone.github.io/tags/if-let/">if let</a></span>
		
		<span class="tag"><a href="https://desmodrone.github.io/tags/while-let/">while let</a></span>
		
		<span class="tag"><a href="https://desmodrone.github.io/tags/rustlings/">rustlings</a></span>
		
		<span class="tag"><a href="https://desmodrone.github.io/tags/modules/">modules</a></span>
		
		<span class="tag"><a href="https://desmodrone.github.io/tags/enums/">enums</a></span>
		
		<span class="tag"><a href="https://desmodrone.github.io/tags/ref/">ref</a></span>
		
		<span class="tag"><a href="https://desmodrone.github.io/tags//">&amp;</a></span>
		
		
    </p>
    
    <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>2959 Words</p>
    
    <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2023-07-31</p>
    
	</footer>
  </article>
    
  
  <div class="post-nav thin">
	
	
  </div>

  
</main>

	  </div>
	  
	  



<footer id="site-footer" class="section-inner thin animated fadeIn faster">
  <p>&copy; 2023 <a href="https:&#x2F;&#x2F;desmodrone.github.io">erick</a> &#183; <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></p>
  <p>Made with <a href="https://www.getzola.org" target="_blank" rel="noopener">Zola</a> &#183; Theme <a href="https://github.com/VersBinarii/hermit_zola" target="_blank" rel="noopener">Hermit_Zola</a>
	
	&#183; <a href="https://desmodrone.github.io/rss.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
	
  </p>
</footer>




	</div>
	
	<script src="https://desmodrone.github.io/js/main.js"></script>

	<!-- Math rendering -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
        onload="renderMathInElement(document.body, { delimiters: [ {left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}, {left: '\\[', right: '\\]', display: true}, {left: '\\(', right: '\\)', display: false}]});"></script>

    
		<link href="https://unpkg.com/highlightjs-badge/highlightjs/styles/railscasts.css" rel="stylesheet">
		<!-- https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.1/build/styles/  for min version -->
		<script src="https://unpkg.com/highlightjs-badge/highlightjs/highlight.pack.js"></script>
		<script src="https://unpkg.com/highlightjs-badge/highlightjs-badge.min.js"></script>
		<script>
			var pres = document.querySelectorAll("pre>code");
			for (var i = 0; i < pres.length; i++) {
				hljs.highlightBlock(pres[i]);
			}
		</script>
		
			<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script>
			<script>
				var options = {
					copyIconClass: "gg-clipboard",
					checkIconClass: "gg-check"
				};
				window.highlightJsBadge(options);
			</script>
		

	

	
	<script src="https://desmodrone.github.io/js/main.js"></script>

    
    

	
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9MNTYXYNHK"></script>
    <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());
     gtag('config', 'G-9MNTYXYNHK');
    </script>
    
  </body>
</html>
